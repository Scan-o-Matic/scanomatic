[tox]
envlist = py27, jasmine
skipsdist = true

[testenv]
deps =
    -rrequirements.txt
    mock
    pytest
    pytest-cov
    pytest-docker
    selenium
setenv =
    SCANOMATIC_DATA = {toxinidir}/data/
    PATH=$PATH:/usr/lib/chromium-browser/
    LD_LIBRARY_PATH=/usr/lib/chromium-browser
whitelist_externals =
    chromedriver
passenv =
    DISPLAY
commands =
    pytest \
        --cov scanomatic --cov scripts --cov-report xml --cov-report term \
        --junitxml result.xml --ignore dev \
        {posargs}

[testenv:jasmine]
deps =
    jasmine
setenv =
    SCANOMATIC_DATA = {toxinidir}/data/
    PATH=$PATH:/usr/lib/chromium-browser/
    LD_LIBRARY_PATH=/usr/lib/chromium-browser
whitelist_externals =
    chromedriver
passenv =
    DISPLAY
commands =
    jasmine-ci \
        --config scanomatic/ui_server_data/js/specs/support/jasmine.yml \
        --browser chrome
